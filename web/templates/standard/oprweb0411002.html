<meta name="TemplateVersion" content="V11.03.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb04.js"> </script>
<script type="text/javascript">
function DisplayTrnSrc() {
  i=document.AddForm.oprdd002.selectedIndex;
  ind=document.AddForm.oprdd002.options[i].value.substring(0,1);
  document.AddForm.x_oprtb002.selectedIndex=0;
  if (ind !="1") {
    if (ind =="2") {
      TranSrc.innerHTML=equipmentsrc.innerHTML;
    } else {
      TranSrc.innerHTML=traycodes.innerHTML;
    }
  } else {
    TranSrc.innerHTML=transfersrc.innerHTML;
  }
}
function AddDocPref() {
  if (validateMandatory(AddForm)) {
    AddForm.submit();
  }
}
function searchItem() {
  if (document.AddForm.opcnptmc.value=="1") {
    DefMiscChargeSearchFrame(document.AddForm.oprtb002,
                             document.AddForm.name_oprtb002,
                             document.AddForm.multhosp);
  } else {
    TheatItemSearchFrame(document.AddForm.oprtb002,
                         document.AddForm.name_oprtb002,'8');
  }
}
function validateItem() {
  if (document.AddForm.opcnptmc.value=="1") {
    validateCode(40,document.AddForm.oprtb002,document.AddForm.name_oprtb002);
  } else {
    validateCode(23,AddForm.oprtb002,AddForm.name_oprtb002);
  }
}
function chkquantity() {
  if (checkInteger(AddForm.oprdd004,AddForm.oprdd004.title)) {
      if (trim(AddForm.oprdd004.value)=='0' || isWhitespace(trim(AddForm.oprdd004.value))) {
        alert ('Quantity must not be Zero');
        AddForm.oprdd004.value='1';}
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif 
     onclick="DFrameExitRefresh();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>
<form name=AddForm method=post action=oprweb04.pbl style="margin:0"
 onsubmit='return validateMandatory();'>
<input type=hidden name=reportno value="11">
<input type=hidden name=template value="002">
<input type=hidden name=updttype value="A">
<input type=hidden name=x_oprtb002>
<input type=hidden name=doctcode value="%OPRWEB04.11.003">
<input type=hidden name=prefcode value="%OPRWEB04.11.102">
<input type=hidden name=opcnptmc value="%STANDARD.01.025.113. 66.0.1">
<input type=hidden name=multhosp value="%STANDARD.01.032">

<table align=center width=98% border=0>
<tr><td>
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Doctor </td>
  <td width=%><input type=text name=doctname class=Readonly readonly
       value="%OPRWEB04.11.002" size=35 tabindex=-1>
  </td></tr>

<tr><td class=DataLabel>Preference </td>
    <td><input type=text name=oprdh002 class=Readonly title="Description"
         value="%OPRWEB04.11.103" readonly size=30 maxlength=30 tabindex=-1>
    </td></tr>

<tr><td class=DataLabel>Class </td>
    <td><select name=oprdd001 title="Class" class=Mandatory>
        <option></option>
        %STANDARD.01.007.OG
        </select>
    </td></tr>

<tr><td class=DataLabel>Type </td>
    <td><select name=oprdd002 title="Type" class=Mandatory 
         onchange="DisplayTrnSrc()";>
        <option value=0>Tray</option>
        <option value=1>Item</option>
        <option value=2>Equipment</option>
        </select>
    </td></tr>
</table>

<span id=TranSrc></span>

<table align=center width=100% border=0>
<!--
<tr><td class=DataLabel>Item </td>
    <td><input type=text name=oprtb002 title="Item" 
        class=Mandatory size=8 maxlength=6>
        <input type=text name=name_oprtb002 title="Item Description" 
        size=35 readonly>
        <img src=../images/SearchIcon.gif
    onClick="TheatItemSearchFrame(oprtb002,name_oprtb002);">
        </td></tr>
-->
<tr><td class=DataLabel width=20%>Quantity </td>
    <td><input type=text name=oprdd004 title="Quantity" onblur="chkquantity();"
        class="Mandatory Integer" min=0 size=8 maxlength=6>
    </td></tr>

<tr><td colspan=2 align=center><br>
    <input type=button value="Add" class="button" 
     onclick="AddDocPref();">
    <input type=button value="Close" class="button" 
     onclick='DFrameCloseRefresh();'>
</td></tr>

</table>
</td></tr>
</table>
</form>

<span id=transfersrc style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Item </td>
    <td><input type=text name=oprtb002 title="Item" 
         class=Mandatory size=16 maxlength=15
         onblur="validateItem();">
        <input type=text name=name_oprtb002 title="Item Description" 
         size=80 readonly class=Readonly tabindex=-1>
        <img src=../images/SearchIcon.gif class="Icon"
         onclick="searchItem();">
    </td></tr>
</table>
</span>

<span id=traycodes style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Tray </td>
    <td><select name=oprtb002 class=Mandatory>
         <option></option>
          %OPRWEB04.11.208
         </select>
    </td></tr>
</table>
</span>

<span id=equipmentsrc style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Equipment </td>
    <td><input type=text name=oprtb002 title="Item"
         class=Mandatory size=16 maxlength=15
         onblur="validateCode2('16',AddForm.oprtb002,AddForm.name_oprtb002);">
        <input type=text name=name_oprtb002 title="Equipment Description"
         size=90 readonly class=Readonly tabindex=-1>
        <img src=../images/SearchIcon.gif class="Icon"
         onClick="EquipmentSearchFrame(AddForm.oprtb002,
                  AddForm.name_oprtb002,'7');">
    </td></tr>
</table>
</span>
