<meta name="TemplateVersion" content="V11.03.04">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<!--        Sub-Frame Header Section       -->
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Condition - %PATWEB93.05.002
</span>
<!--        Sub-Frame Details Sections     -->
<form name=PatCondPopup style="margin:0" method=post %PATWEB93.05.101
<input type=hidden name=nextpatn value="patweb93.pbl?reportno=05&template=001">
<input type=hidden name=dummy value="">
<input type=hidden id=pmsvx052 name=pmsvx052 value="%PATWEB93.05.352">
<input type=hidden id=pmsvx053 name=pmsvx053 value="%PATWEB93.05.353">
<input type=hidden id=pmsvx054 name=pmsvx054 value="%PATWEB93.05.354">
<input type=hidden id=pmsvx055 name=pmsvx055 value="%PATWEB93.05.355">
<input type=hidden id=workdiag name=workdiag value="%PATWEB93.05.212">
<input name="myChars" type="hidden"
  value="0" size="4" maxlength="4">
<input name="maxChars" type="hidden"
  value="0" size="4" maxlength="4">
<input name="myLines" type="hidden"
  value="0" size="4" maxlength="3">
<input name="maxLines" type="hidden"
  value="0" size="4" maxlength="3">

<table border=0 align=center width=100%>
<tr>
    <td class=DataLabel>Last Update</td>
    <td><input type=text class=readonly readonly size=20 name=patconup
               value="%PATWEB93.05.108"></td></tr>
<tr><td class=DataLabel>Condition </td>
    <td><select name=patconcd>
        <option value="   "></option>
        %PATWEB93.05.102
        </select>
<tr><td class=DataLabel>Ambulatory Status</td>
    <td><select name=patconam>
        <option value="   "></option>
        %PATWEB93.05.107
        </select>
<tr><td class=DataLabel> Visitors Allowed ?</td>
    <td><input name=patconva type=checkbox value=1>                   
    </td></tr>
<tr><td class=DataLabel> Phone Calls Allowed ?</td>
    <td><input name=patconpa type=checkbox value=1>                   
    </td></tr>
<tr><td class=DataLabel>%STANDARD.01.017.U2</td>
    <td><select name=ptmis038 title="">
        <option value="   "></option>
        %PATWEB93.05.109.5
        </select>
    </td></tr>
<tr><td class=DataLabel>Discharge Preparation Status</td>
    <td><select name=pmswo007 title="Discharge Preparation Status">
        <option value="   "></option>
        %PATWEB93.05.214.2
        </select>
    </td></tr>
<tr><td class=DataLabel>Expected Discharge Date</td>
    <td><input type=text size=12 name=pmswo005 tabindex=31
         class="FutureDate" value="%PATWEB93.05.205"
         title="Expected Discharge Date">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(PatCondPopup.pmswo005);">
        Time
        <input type=text name=pmswo006 size=8 title="Expected Discharge Time"
         value="%PATWEB93.05.213">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(PatCondPopup.pmswo005,
                                     PatCondPopup.pmswo006);">
        <img notab src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(PatCondPopup.pmswo006);">
    </td></tr>
<tr><td class=DataLabel> Comments</td>
    <td><input name=patconds size=35 maxlength=35 value="%PATWEB93.05.103"
         onblur="validateFreeTextFields(this);">
    </td></tr>

<tr>
    <td class="DataLabel">Discharge Coordinator</td>
    <td><input type="text" size="10" maxlength="10" name="pmswo008"
      value="%PATWEB93.05.215.1"
      onblur="ValidateHCP(18,0,PatCondPopup.pmswo008,PatCondPopup.doctnam1);">
    <input type="text" size="25" notab readonly class=Readonly
      name="doctnam1" value="%PATWEB93.05.215.2">
    <img src="../images/SearchIcon.gif" class="Icon"
      onclick="HCPSearchFrame(PatCondPopup.pmswo008,PatCondPopup.doctnam1,0);">
    <img src="../images/erase.gif" class=Icon
      onclick="clrFields(PatCondPopup.pmswo008,
                         PatCondPopup.doctnam1);">
    <td></tr>

<tr><td>Expected Discharge Destination</td>
    <td><input type="text" size=10 maxlength=5 name=pmswo009
     title="Transfer Destination" value="%PATWEB93.05.216.1"
     onblur="validateTransSrc(PatCondPopup.pmswo009,
                              PatCondPopup.dummy,
                              PatCondPopup.trandesc);">
   <input type=text size=25 name=trandesc notab class=Readonly readonly
     value="%PATWEB93.05.216.2">
   <img src="../images/SearchIcon.gif" class=Icon
     onclick="TransferSourceFrame(PatCondPopup.pmswo009,PatCondPopup.trandesc)">
   <img src="../images/erase.gif" class=Icon
     onclick="clrFields(PatCondPopup.pmswo009,
                        PatCondPopup.trandesc);">
   </td>
</tr>

<tr valign=top><td class=DataLabel>Working Diagnosis</td>
<td class=DataField colspan=3>
<textarea name=wdcom001 id=wdcom001 cols="35" rows="3" wrap="hard"
 style="font-size:14px; line-height:17px; overflow-y:hidden"
 title="Working Diagnosis"
 onkeydown="LimitText(this,3,105)"
 onblur="TextareaBlurHandler(this);ValidateTextLimit(this);"></textarea>
</td></tr>

<tr valign=top><td class=DataLabel>History</td>
<td class=DataField colspan=3>
<input type=hidden name=histmyChars>
<input type=hidden name=histmyLines>
<textarea name=hiscomnt id=hiscomnt cols="50" rows="4" wrap="hard"
 style="font-size:14px; line-height:17px;"
 title="History"
 onkeyup="checkLimits(PatCondPopup.hiscomnt,
                      PatCondPopup.histmyChars,
                      PatCondPopup.histmyLines);">
</textarea>
</td></tr>

<tr><td align=center colspan=2>
<input type=button value="Update" class="button" id=pat93sub
       onclick="tempDisable(this, 5);checkFields();">
<input type=button value="Cancel" class="button"
       onclick="DFrameCloseRefresh();">

</td></tr>
</table>
</form>
 
<script type="text/javascript">
if ("%PATWEB93.05.106.1" == "1")
{
  document.PatCondPopup.patconva.checked="1";
}
if ("%PATWEB93.05.106.2" == "1")
{
  document.PatCondPopup.patconpa.checked="1";
}

// Load 'Working Diagnosis' text
var arrWorkingDiag = document.getElementById('workdiag').value.split(/\r?\n/);
document.getElementById('wdcom001').value = 
  arrWorkingDiag[0] + "\n" + arrWorkingDiag[1] + "\n" + arrWorkingDiag[2];

// Load 'History' text
var line1 = document.getElementById('pmsvx052').value;
var line2 = document.getElementById('pmsvx053').value;
var line3 = document.getElementById('pmsvx054').value;
var line4 = document.getElementById('pmsvx055').value;

document.getElementById('hiscomnt').value =
  trim(line1) + "\n" + trim(line2) + "\n" + trim(line3) + "\n" + trim(line4);

function checkFields() {
  splitComments();
  PatCondPopup.submit();
}

function splitComments() {
  var textarea = document.getElementById('hiscomnt');

  var arr = new Array();
  for (var i = 0; i < 4; i++) {
    arr[i] = textarea.value.replace(/\r?\n/g,"").substr((i*50),50);
  }

  pmsvx052 = document.getElementById('pmsvx052');
  pmsvx053 = document.getElementById('pmsvx053');
  pmsvx054 = document.getElementById('pmsvx054');
  pmsvx055 = document.getElementById('pmsvx055');

  pmsvx052.value = arr[0];
  pmsvx053.value = arr[1];
  pmsvx054.value = arr[2];
  pmsvx055.value = arr[3];
}
function validateFreeTextFields(textfieldvar) {
  textfieldvar.value=textfieldvar.value.replace(/</g,"< ");
  textfieldvar.value=textfieldvar.value.replace(/"/g,"'");
  textfieldvar.value=textfieldvar.value.replace(/\\/g,"/");
}
function ValidateTextLimit(TextArea) {
  var maxLines = TextArea.rows + 0;
  var maxChars = (TextArea.cols + 0) * maxLines;

  var formatedtext = formateText(TextArea,TextArea.cols);

  TextArea.value = formatedtext;

  if (formatedtext.split(/\r?\n/).length > maxLines) {
    alert(TextArea.title + " - Max " + maxLines + " lines." +
          "\nPlease remove the extra line(s) to continue.");
    FocusDelay(TextArea);

    TextArea.onblur = null;  // clear to prevent infinite loop with alerts
    window.setTimeout(function () {
      TextArea.onblur = function() {
        TextareaBlurHandler(TextArea);
        ValidateTextLimit(TextArea);
      }
    },100);

    return;
  }
  else if (formatedtext.replace(/\r?\n/gm,"").length > maxChars) {
    alert(TextArea.title + " - Max " + maxChars + " characters." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(TextArea);

    TextArea.onblur = null;  // clear to prevent infinite loop with alerts
    window.setTimeout(function () {
      TextArea.onblur = function() {
        TextareaBlurHandler(TextArea);
        ValidateTextLimit(TextArea);
      }
    },100);

    return;
  }
}
</script>
